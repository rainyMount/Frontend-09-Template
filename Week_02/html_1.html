<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>实现一个地图编辑器</title>
    <style>
        #map {
            width: 901px;
        }
        .cell {
            /* box-sizing: border-box; */
            display: inline-block;
            width: 8px;
            height: 8px;
            line-height: 8px;
            background: gray;
            border-right: 1px solid #fff;
            border-bottom: 1px solid #fff;
            vertical-align: middle;
            float: left;
        }
    </style>
</head>
<body>

    <div id="map"></div>
    <button onclick="localStorage.setItem('map', JSON.stringify(map))">保存</button>
    
    <script>
        let map = localStorage.getItem('map') ? JSON.parse(localStorage.getItem('map')) : Array(10000).fill(0);

        let container = document.getElementById('map');
        for (let y=0; y<100; y++) {
            for (let x=0; x<100; x++) {
                let cell = document.createElement('div');
                cell.classList.add('cell');

                if (map[100 * y + x] == 1) {
                    cell.style.backgroundColor = '#000'
                }

                cell.addEventListener('mousemove', () => {
                    if (mouseDown) {
                        if (clear) {
                            cell.style.backgroundColor = 'gray';
                            map[100 * y + x] = 0
                        } else {
                            cell.style.backgroundColor = '#000';
                            map[100 * y + x] = 1
                        }
                    }
                })

                container.appendChild(cell);
            }
            // container.appendChild(document.createElement('br'))
        }

        let mouseDown = false, 
            clear = false;
        document.addEventListener('mouseup', () => mouseDown = false);
        document.addEventListener('mousedown', e => {
            mouseDown = true;

            // 单击右键清除
            clear = e.which == 3;
        })
        // 阻止右键默认事件
        document.addEventListener('contextmenu', e => e.preventDefault());
    </script>
</body>
</html>